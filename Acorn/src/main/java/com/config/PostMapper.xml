<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.domain.dto.PostMapper">


    <!-- 삽입 -->
	<insert id="insertContent" parameterType="PostDTO">
	    <selectKey keyProperty="postId" resultType="long" order="BEFORE">
	        SELECT POSTIDSEQ.NEXTVAL AS postId FROM DUAL
	    </selectKey>
	    INSERT INTO postDB (postid, postBoard, userid, contid, postTitle, postDate, postEditDate, postText)
	    VALUES (#{postId}, #{postBoard}, #{userId}, #{contId, jdbcType=NUMERIC}, #{postTitle}, SYSTIMESTAMP, null, #{postText})
	</insert>
	
    <!-- 조회 -->
    <select id="select" resultType="PostDTO" parameterType="Long">
        SELECT * FROM postdb WHERE postid = #{postId}
    </select>

    <!-- 삭제 -->
    <delete id="deletePost" parameterType="long">
        DELETE FROM postdb WHERE postid = #{postId}
    </delete>

    <!-- 전체 조회 -->
    <select id="selectAll" resultType="PostDTO">
        SELECT * FROM postdb WHERE postBoard = #{board}
    </select>

    <!-- 업데이트 -->
    <update id="updateContent" parameterType="map">
        UPDATE postdb
        SET postTitle = #{updatedTitle},
            postText = #{updatedContent},
            postEditDate = SYSTIMESTAMP
        WHERE postId = #{postId}
    </update>

</mapper>
